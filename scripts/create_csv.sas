PROC SQL;
CREATE TABLE WORK.query AS
SELECT 'ZONE'n , CHP2TXT1 , AMTFINEC , AMTREST , AMTTOTAL , SENTTOT , SENSPLT0 , SENTTCAP , SENSPCAP , TIMSERVC , USSCIDN , ACCAP , ACCCAT , ACCGDLN , ACCOFFLV , ACCTRESP , AGE , ALTMO , ARMCRIM , CAROFFEN , CAROFFAP , CAROFFLV , CASETYPE , CHAP2 , CHEMTYP1 , CIRCDIST , CITIZEN , CITWHERE , CO924TAB , COADJLEV , COMBDRG2 , CRIMHIST , CRIMLIV , CRIMPTS , CRMLIVAP , CUNIT1 , DISPOSIT , DISTRICT , DTGDL , DUFROM1 , DUFROM2 , DUTO1 , DUTO2 , EDUCATN ,  HISPORIG , HOMDUM , INNOPL1 , INNOPL2 , INPLEA1 , INPLEA2 , 'INOUT'n , INTDUM , IS924C , IS1028A , ISMETHMIN , MAND1 , MAND2 , MAND3 , MAND4 , MAND5 , MAND6 , MOCOMCON , MOHOMDET , MOINTCON , MONACCEP , MONCIRC , MONRACE , MONSEX , MONSXOFB , NEWCNVTN , NEWEDUC , NEWRACE , NOCOMP , NOCOUNTS , NOUSTAT , NODRUG , NOCHEM , NUMDEPEN , OFFGUIDE , ONLY924C , ONLY1028A , POINT1 , POINT2 , POINT3 , PRESENT , PRISDUM , PROBDUM , RANGEPT , REL2PTS , RESTDET1 , RESTDET2 , SAFE , SAFETY , SENTIMP , SENTPTS , SENTRNGE , SEXOFFNA , SEXOFFNB , SEXACCA , SEXACCB , SORFORM , SUPRDUM , TOTCHPTS , TOTDAYS , TYPEMONY , TYPEOTHS , UNIT1 , UNIT2 , UNIT3 , UNIT4 , WEAPON , WEAPSOC , WEAPSCHI , XCRHISSR , XFOLSOR , CHP2CHG1 , CHP2CHG2 , CHP3CHG1 , CHP3CHG2 , CHP4CHG1 , CHP4CHG2 , DRUGMIN , DRUGTYP1 , DRUGTYP2 , DRUGTYP3 , GLMIN , GLMAX , GUNMIN1 , GUNMIN2 , FIREMIN1 , FIREMIN2 , FAILMIN , HRCOMSRV , METHMIN , PROBATN , REAS1 , REAS2 , SEXMIN , SMIN1 , SMIN2 , SMIN3 , SMAX1 , SMAX2 , SMAX3 , STATMAX , STATMIN , SUPREL , TOTPRISN , TIMSERVM , TIMSERVD , ABUS1 , ABUS2 , ABUS3 , ADJOFL1 , ADJ_C1 , ADJ_G1 , ADJ_H1 , ADJ_I1 , ADJ_J1 , ADJ_K1 , ADJ_L1 , ADJ_M1 , ADJ_N1 , ADJ_O1 , ADJ_P1 , AGGROL1 , AGGROL2 , OFFVCT1 , RSTRVC1 , TEROR1 , USKID1 , VULVCT1 , RLEAS1 , HUMAN1 , SEXADJB , STA1_1, STA2_1, DAFROM1 , DAFROM2 , DRGAM1 , DRGAM2 , DATO1 , DATO2 , IMMIMIN , LOSS1 , LOSS2 ,  MNTHDEPT , MWEIGHT , MWGT1 , MWGT2 , NWSTAT1 , NWSTAT2 ,  PCNTDEPT ,  BOOKERCD , SENTTOT0 , SENTTOT1 , SENTTOT2 , SENTTOT3
    FROM _TEMP2.opafy18nid;
RUN;
QUIT;

/* 2015: SELECT 'ZONE'n , CHP2TXT1 , AMTFINEC , AMTREST , AMTTOTAL , SENTTOT , SENSPLT0 ,   TIMSERVC , USSCIDN , ACCAP , ACCCAT , ACCGDLN , ACCOFFLV , ACCTRESP , AGE , ALTMO , ARMCRIM , CAROFFEN , CAROFFAP , CAROFFLV ,  CHAP2 , CHEMTYP1 , CIRCDIST , CITIZEN , CITWHERE , CO924TAB , COADJLEV , COMBDRG2 , CRIMHIST , CRIMLIV , CRIMPTS , CRMLIVAP , CUNIT1 , DISPOSIT , DISTRICT ,  DUFROM1 , DUFROM2 , DUTO1 , DUTO2 , EDUCATN ,  HISPORIG , HOMDUM , INNOPL1 , INNOPL2 , INPLEA1 , INPLEA2 , 'INOUT'n , INTDUM , IS924C , IS1028A , ISMETHMIN , MAND1 , MAND2 , MAND3 , MAND4 , MAND5 , MAND6 , MOCOMCON , MOHOMDET , MOINTCON , MONACCEP , MONCIRC , MONRACE , MONSEX , MONSXOFB , NEWCNVTN , NEWEDUC , NEWRACE , NOCOMP , NOCOUNTS , NOUSTAT , NODRUG , NOCHEM , NUMDEPEN ,  ONLY924C , ONLY1028A , POINT1 , POINT2 , POINT3 , PRESENT , PRISDUM , PROBDUM , RANGEPT , REL2PTS , RESTDET1 , RESTDET2 , SAFE , SAFETY , SENTIMP , SENTPTS ,  SEXOFFNA , SEXOFFNB , SEXACCA , SEXACCB , SORFORM , SUPRDUM , TOTCHPTS , TOTDAYS , TYPEMONY , TYPEOTHS , UNIT1 , UNIT2 , UNIT3 , UNIT4 , WEAPON , WEAPSOC ,  XCRHISSR , XFOLSOR , CHP2CHG1 , CHP2CHG2 , CHP3CHG1 , CHP3CHG2 , CHP4CHG1 , CHP4CHG2 , DRUGMIN , DRUGTYP1 , DRUGTYP2 , DRUGTYP3 , GLMIN , GLMAX , GUNMIN1 , GUNMIN2 , FIREMIN1 , FIREMIN2 , FAILMIN , HRCOMSRV , METHMIN , PROBATN , REAS1 , REAS2 , SEXMIN , SMIN1 , SMIN2 , SMIN3 , SMAX1 , SMAX2 , SMAX3 , STATMAX , STATMIN , SUPREL , TOTPRISN , TIMSERVM , TIMSERVD , ABUS1 , ABUS2 , ABUS3 , ADJOFL1 , ADJ_C1 , ADJ_G1 , ADJ_H1 , ADJ_I1 , ADJ_J1 , ADJ_K1 , ADJ_L1 , ADJ_M1 , ADJ_N1 , ADJ_O1 , ADJ_P1 , AGGROL1 , AGGROL2 , OFFVCT1 , RSTRVC1 , TEROR1 , USKID1 , VULVCT1 , RLEAS1 , HUMAN1 , SEXADJB , STA1_1, STA2_1, DAFROM1 , DAFROM2 , DRGAM1 , DRGAM2 , DATO1 , DATO2 , IMMIMIN , LOSS1 , LOSS2 ,   MWEIGHT , MWGT1 , MWGT2 , NWSTAT1 , NWSTAT2 ,    BOOKERCD , SENTTOT0  */
/* 2016: SELECT 'ZONE'n , CHP2TXT1 , AMTFINEC , AMTREST , AMTTOTAL , SENTTOT , SENSPLT0 ,   TIMSERVC , USSCIDN , ACCAP , ACCCAT , ACCGDLN , ACCOFFLV , ACCTRESP , AGE , ALTMO , ARMCRIM , CAROFFEN , CAROFFAP , CAROFFLV ,  CHAP2 , CHEMTYP1 , CIRCDIST , CITIZEN , CITWHERE , CO924TAB , COADJLEV , COMBDRG2 , CRIMHIST , CRIMLIV , CRIMPTS , CRMLIVAP , CUNIT1 , DISPOSIT , DISTRICT ,  DUFROM1 , DUFROM2 , DUTO1 , DUTO2 , EDUCATN ,  HISPORIG , HOMDUM , INNOPL1 , INNOPL2 , INPLEA1 , INPLEA2 , 'INOUT'n , INTDUM , IS924C , IS1028A , ISMETHMIN , MAND1 , MAND2 , MAND3 , MAND4 , MAND5 , MAND6 , MOCOMCON , MOHOMDET , MOINTCON , MONACCEP , MONCIRC , MONRACE , MONSEX , MONSXOFB , NEWCNVTN , NEWEDUC , NEWRACE , NOCOMP , NOCOUNTS , NOUSTAT , NODRUG , NOCHEM , NUMDEPEN ,  ONLY924C , ONLY1028A , POINT1 , POINT2 , POINT3 , PRESENT , PRISDUM , PROBDUM , RANGEPT , REL2PTS , RESTDET1 , RESTDET2 , SAFE , SAFETY , SENTIMP , SENTPTS ,  SEXOFFNA , SEXOFFNB , SEXACCA , SEXACCB , SORFORM , SUPRDUM , TOTCHPTS , TOTDAYS , TYPEMONY , TYPEOTHS , UNIT1 , UNIT2 , UNIT3 , UNIT4 , WEAPON , WEAPSOC ,  XCRHISSR , XFOLSOR , CHP2CHG1 , CHP2CHG2 , CHP3CHG1 , CHP3CHG2 , CHP4CHG1 , CHP4CHG2 , DRUGMIN , DRUGTYP1 , DRUGTYP2 , DRUGTYP3 , GLMIN , GLMAX , GUNMIN1 , GUNMIN2 , FIREMIN1 , FIREMIN2 , FAILMIN , HRCOMSRV , METHMIN , PROBATN , REAS1 , REAS2 , SEXMIN , SMIN1 , SMIN2 , SMIN3 , SMAX1 , SMAX2 , SMAX3 , STATMAX , STATMIN , SUPREL , TOTPRISN , TIMSERVM , TIMSERVD , ABUS1 , ABUS2 , ABUS3 , ADJOFL1 , ADJ_C1 , ADJ_G1 , ADJ_H1 , ADJ_I1 , ADJ_J1 , ADJ_K1 , ADJ_L1 , ADJ_M1 , ADJ_N1 , ADJ_O1 , ADJ_P1 , AGGROL1 , AGGROL2 , OFFVCT1 , RSTRVC1 , TEROR1 , USKID1 , VULVCT1 , RLEAS1 , HUMAN1 , SEXADJB , STA1_1, STA2_1, DAFROM1 , DAFROM2 , DRGAM1 , DRGAM2 , DATO1 , DATO2 , IMMIMIN , LOSS1 , LOSS2 ,   MWEIGHT , MWGT1 , MWGT2 , NWSTAT1 , NWSTAT2 ,    BOOKERCD , SENTTOT0 */

PROC DATASETS NOLIST NODETAILS;
CONTENTS DATA=WORK.query OUT=WORK.details;
RUN;

PROC PRINT DATA=WORK.details;
RUN;

PROC EXPORT data=WORK.query  
	outfile='/folders/myfolders/opafy18trim.csv'  
	dbms=csv
	replace;
RUN;